!function(t){function e(e){for(var r,i,l=e[0],c=e[1],s=e[2],d=0,f=[];d<l.length;d++)i=l[d],a[i]&&f.push(a[i][0]),a[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);for(u&&u(e);f.length;)f.shift()();return o.push.apply(o,s||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],r=!0,l=1;l<n.length;l++){var c=n[l];0!==a[c]&&(r=!1)}r&&(o.splice(e--,1),t=i(i.s=n[0]))}return t}var r={},a={0:0},o=[];function i(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/Evo-Bio-Design-Study/";var l=window.webpackJsonp=window.webpackJsonp||[],c=l.push.bind(l);l.push=e,l=l.slice();for(var s=0;s<l.length;s++)e(l[s]);var u=c;o.push([133,1]),n()}({133:function(t,e,n){"use strict";n.r(e);n(14),n(20),n(16),n(17),n(52),n(54),n(21);var r=n(0);function a(t,e,n,r,a,o,i){try{var l=t[o](i),c=l.value}catch(t){return void n(t)}l.done?e(c):Promise.resolve(c).then(r,a)}function o(t,e,n){return i.apply(this,arguments)}function i(){var t;return t=regeneratorRuntime.mark(function t(e,n,r){var a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e(n);case 2:return(a=t.sent).type=String(r),t.abrupt("return",a);case 5:case"end":return t.stop()}},t)}),(i=function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function l(t){a(i,r,o,l,c,"next",t)}function c(t){a(i,r,o,l,c,"throw",t)}l(void 0)})}).apply(this,arguments)}n(111),n(55),n(23);function l(t,e){return Object.keys(t).map(function(n,a){if("continuous"==t[n].type){var o=r.l(t[n].rows.map(function(t){return t.upperCI95})),i=r.n(t[n].rows.map(function(t){return t.lowerCI95}));r.m(t[n].rows.map(function(t){return t.realVal}));return{field:n,type:"continuous",max:o,min:i,yScale:r.o().range([0,43]).domain([i,o]).clamp(!0),satScale:r.o().range([0,.9]).domain([i,o]),colorScale:r.o().range([e[a][0],"#f23929"]).domain([i,o]),catColor:e[a][0]}}var l=t[n].fields.filter(function(t){return"nodeLabels"!=t});return{field:n,type:"discrete",stateColors:l.map(function(t,n){return{state:t,color:e[n][0]}}),catColor:e[a][0],scales:l.map(function(t){return{field:n,scaleName:t,max:1,min:0,yScale:r.o().range([45,0]).domain([0,1])}})}})}function c(t,e,n,r){var a=t.rows.map(function(t){return t.x});return e.map(function(t,e){t.label=a[e];var o=n.rows.map(function(t){return t[""]});t.node=t.V2;var i=r.map(function(t){return t.field}),l={},c=n.rows[o.indexOf(t.label)];return i.forEach(function(t){var e=r.filter(function(e){return e.field==t})[0];if("discrete"===e.type){var n=e.scales.filter(function(e){return e.scaleName==c[t]})[0].yScale,a=e.scales.map(function(t){return t.scaleName}).map(function(e){var r=e===c[t]?1:0;return{state:e,scaleVal:n(r),realVal:r}});l[t]={states:a,label:t,type:e.type,leaf:!0}}else if("continuous"===e.type){var o=e.yScale;l[t]={scaleVal:o(c[t]),scaledHigh:0,scaledLow:0,realVal:c[t],type:e.type,leaf:!0}}else l[t]="error in leaf matching"}),t.attributes=l,t.leaf=!0,t})}function s(t,e,n,r){return t.rows.map(function(t,a){var o=Object.keys(n),i=n[o[0]].rows.map(function(t){return t.nodeLabels}).indexOf(t.V2);return t.edgeLength=e.rows[a].x,t.node=t.V2,i>-1&&o.forEach(function(e){if("continuous"==n[e].type){var a=r.filter(function(t){return t.field==e})[0].yScale,o=n[e].rows[i];o.scaleVal=a(o.estimate),o.scaledLow=a(o.lowerCI95),o.scaledHigh=a(o.upperCI95),o.realVal=o.estimate,o.type="continuous",t.attributes=null!=t.attributes?t.attributes:{},t.attributes[e]=o}else{var l=r.filter(function(t){return t.field==e})[0].scales,c=n[e].rows[i],s=l.map(function(t){return{state:t.scaleName,scaleVal:t.yScale(c[t.scaleName]),realVal:c[t.scaleName]}});t.attributes=null!=t.attributes?t.attributes:{},t.attributes[e]={states:s,type:"discrete"}}}),t})}function u(t,e,n){t.forEach(function(t,r){t[0].attributes={},Object.keys(e).map(function(r){if("continuous"==e[r].type){var a=e[r].rows.filter(function(e){return e.nodeLabels==t[0].node})[0];t[0].attributes[r]={};var o=n.filter(function(t){return t.field==r})[0].yScale;t[0].attributes[r].scaleVal=o(a.estimate),t[0].attributes[r].scaledLow=o(a.lowerCI95),t[0].attributes[r].scaledHigh=o(a.upperCI95),t[0].attributes[r].realVal=a.estimate,t[0].attributes[r].upperCI95=a.upperCI95,t[0].attributes[r].lowerCI95=a.lowerCI95,t[0].attributes[r].scale=o,t[0].attributes[r].type="continuous"}else if("discrete"==e[r].type){var i=e[r].rows.filter(function(e){return e.nodeLabels==t[0].node})[0],l=n.filter(function(t){return t.field==r})[0].scales.map(function(t){return{state:t.scaleName,scaleVal:t.yScale(i[t.scaleName]),realVal:i[t.scaleName]}});t[0].attributes[r]={states:l,type:"discrete"}}else console.error("type not found")})});var a=r.l(t.map(function(t){return t.length})),o=r.o().range([0,1e3]).clamp(!0);return t.map(function(t,e){t.xScale=o.domain([0,a-1]);var n=t.length-1,r=(t.map(function(t){return t.edgeLength}),0);return t.map(function(e,o){var i=Object.assign({},e),l=i.edgeLength+r;return i.edgeMove=o<n?l:1,r+=i.edgeLength,i.move=o<n?t.xScale(o):t.xScale(a-1),i})})}function d(t,e,n){var r=null==n?Object.keys(t[0][0].attributes):n;return t.map(function(t){return r.map(function(n){return t.map(function(t){if("continuous"===t.attributes[n].type)return t.attributes[n].color=e.filter(function(t){return t.field===n})[0].catColor,t.attributes[n].move=t.move,t.attributes[n].edgeMove=t.edgeMove,t.attributes[n].label=n,t.attributes[n].yScale=e.filter(function(t){return t.field===n})[0].yScale,t.attributes[n].satScale=e.filter(function(t){return t.field===n})[0].satScale,t.attributes[n].colorScale=e.filter(function(t){return t.field===n})[0].colorScale,t.attributes[n];if("discrete"===t.attributes[n].type){if(t.leaf){var r=t.attributes[n];return r.winState=t.attributes[n].states.filter(function(t){return 1===t.realVal})[0].state,r.color=e.filter(function(t){return t.field===n})[0].stateColors.filter(function(t){return t.state===r.winState})[0].color,r.move=t.move,r.edgeMove=t.edgeMove,r.attrLabel=n,r}return(t.attributes[n].states?t.attributes[n].states:t.attributes[n]).map(function(r,a){return r.color=e.filter(function(t){return t.field===n})[0].stateColors.filter(function(t){return t.state===r.state})[0].color,r.move=t.move,r.edgeMove=t.edgeMove,r.attrLabel=n,r})}console.error("attribute type not found")})})})}n(33),n(34),n(35),n(90),n(36),n(24),n(37),n(38),n(39);function f(t,e,n,r){return e.map(function(e){return function t(e,n,r,a,o){var i=e.filter(function(t){return t[o]===n[a]});return i.length>0?(r.push(i[0]),t(e,i[0],r,a,o)):(r.push({root:!0,node:n[a],edgeLength:0}),r.reverse())}(t,e,[e],n,r)})}n(40),n(41),n(96),n(42),n(123),n(98),n(124);function p(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var v=[];function m(t,e,n,a,o){var i=r.q("#filter-tab");i.classed("hidden")?(t.text("Hide Filters"),i.classed("hidden",!1),n.style("padding-top","200px"),function(t,e,n,a){var o=Object.keys(e[0][0].attributes),i=v.filter(function(t){return"hide-attribute"===t.type}),l=i.length>0?i.map(function(t){return t.attribute}):[],c=t.append("div").classed("filter-wrap",!0);c.style("width","150px");var s=c.append("svg").classed("attr-toggle-svg",!0);s.append("text").text("Attributes: ").attr("x",20).attr("y",10);var u=s.append("g").attr("transform","translate(20, 25)").selectAll("g").data(o).join("g");u.attr("transform",function(t,e){return"translate(0,"+25*e+")"});var f=u.append("circle").attr("cx",0).attr("cy",0);f.classed("toggle",!0);var m=f.filter(function(t){return-1===l.indexOf(t)});m.classed("shown",!0),m.style("fill",function(t,e){return n.filter(function(e){return e.field===t})[0].catColor}),f.on("click",function(t,o){var i=r.q(this);!function(t,e){t.classed("shown")?(t.classed("shown",!1),t.style("fill","#fff")):(t.classed("shown",!0),t.style("fill",function(t,n){return e.filter(function(e){return e.field===t})[0].catColor}))}(i,n),v.push({"filter-type":"hide-attribute",attribute:t,"before-data":p(e)});var l=r.r(".shown"),c=n.filter(function(t){return-1===l.data().indexOf(t.field)}),s=v.filter(function(t){return"hide-attribute"!=t.type});c.forEach(function(t){s.push({type:"hide-attribute",attribute:t.field,"before-data":p(e)})}),v=s;var u=r.r(".attribute-wrapper");u.selectAll("g").remove();var f=r.q("#scrunch").attr("value"),m=v.filter(function(t){return"hide-attribute"===t.type}),h=m.length>0?n.filter(function(t){return t.field!=m[0].attribute}).map(function(t){return t.field}):null,g=null===h?n.length:h.length,b="true"===f?20:45,y=d(e,n,l.data()),x=q(u,y,n,null,f);L(x,a,f),C(x,n,a,f),O(r.q("#main-path-view"),u,e,g*b)}),u.append("text").text(function(t){return t}).style("font-size",10).attr("transform","translate(10, 4)")}(i,e,o,"edgeLength"),function(t,e,n,a,o,i){var l=["Select a Trait"].concat(Object.keys(n[0][0].attributes)),c=t.append("div").classed("filter-wrap",!0);c.style("width","200px"),c.append("h6").text("State Transition:");var s=b(c,l,"attr-select",""),u=c.append("div").classed("attribute-properties",!0);s.on("change",function(l){var c=r.q(this).property("value"),s=i.filter(function(t){return t.field===c})[0];if(u.selectAll("*").remove(),"discrete"===s.type){var d=["Any"],f=s.scales.map(function(t){return t.scaleName});d=d.concat(f);var m=b(u,d,"predicted-state","From"),y=b(u,d,"observed-state","To"),x=u.append("button").classed("btn btn-outline-success",!0);x.text("Filter"),x.on("click",function(){var l=m.node().classList[0],s=y.node().classList[0],u=v.filter(function(t){return"data-filter"===t.filterType});console.log(u);var d=u.length>0?u[u.length-1].data:K[0],f=g(d,c,l,s),p={filterType:"data-filter","attribute-type":"discrete",filterFunction:g,attribute:c,states:[l,s],data:f};v.push(p),console.log(r.q("#scrunch").attr("value")),j(f,a,i,o);var h=r.q("#sidebar").selectAll(".link"),b=r.q("#sidebar").selectAll(".node"),x=f.flatMap(function(t){return t.map(function(t){return t.node})});r.r(".link-not-there").classed("link-not-there",!1),r.r(".node-not-there").classed("node-not-there",!1);var w=h.filter(function(t){return-1===x.indexOf(t.data.node)});w.classed("link-not-there",!0);var A=b.filter(function(t){return-1===x.indexOf(t.data.node)});A.classed("node-not-there",!0);var S=r.q("#toolbar"),k=S.append("button").classed("btn btn-info",!0),O=k.append("span").classed("badge badge-light",!0);O.text(f.length),k.append("h6").text(l),k.append("i").classed("fas fa-arrow-right",!0),k.append("h6").text(s+"  ");var V=k.append("i").classed("close fas fa-times",!0);V.on("click",function(){j(n,a,i,o,r.q("#scrunch").attr("value")),r.r(".link-not-there").classed("link-not-there",!1),r.r(".node-not-there").classed("node-not-there",!1),k.remove()}),e.text("Show Filters"),t.selectAll("*").remove(),t.classed("hidden",!0),a.style("padding-top","0px")})}else{var w=r.o().domain([s.min,s.max]).range([60,0]),A=u.append("svg");A.attr("width",200).attr("height",100);var S=A.selectAll(".range").data([{label:"Ancestors",type:"predicted"},{label:"Leaves",type:"observed"}]).join("g").classed("range",!0);S.attr("transform",function(t,e){return"translate("+125*e+",20)"});var k=S.append("g");k.attr("transform","translate(10, 10)");var O=S.append("text").text(function(t){return t.label+": "});O.attr("x",0).attr("y",0);var V=k.append("rect").attr("width",20).attr("height",50);V.attr("x",10),k.append("g").attr("class","axis axis--y").attr("transform","translate(10,0)").call(r.b(w).ticks(3));var q=r.d().extent([[10,0],[30,60]]).on("end",function(){var t=r.f.selection;if(null==t)handle.attr("display","none");else t.map(w.invert)}),M=k.append("g").call(q);M.call(q.move,[0,60]);var L=u.append("button").classed("btn btn-outline-success",!0);L.text("Filter"),L.on("click",function(){var l=M._groups[0].map(function(t){return t.__brush.selection.map(function(t){return t[1]})}),s=l[0].map(w.invert).sort(),u=l[1].map(w.invert).sort(),d=v.filter(function(t){return"data-filter"===t.filterType});console.log("last",d);var f=d.length>0?d[d.length-1].data:K[0],m=h(f,c,s,u),g={filterType:"data-filter","attribute-type":"continuous",filterFunction:h,attribute:c,ranges:[s,u],"before-data":p(n),data:p(m)};v.push(g),j(m,a,i,o);var b=r.q("#sidebar").selectAll(".link"),y=r.q("#sidebar").selectAll(".node"),x=m.flatMap(function(t){return t.map(function(t){return t.node})});r.r(".link-not-there").classed("link-not-there",!1),r.r(".node-not-there").classed("node-not-there",!1);var A=b.filter(function(t){return-1===x.indexOf(t.data.node)});A.classed("link-not-there",!0);var S=y.filter(function(t){return-1===x.indexOf(t.data.node)});S.classed("node-not-there",!0);var k=r.q("#toolbar"),O=r.g(".2s"),V=k.append("button").classed("btn btn-info",!0);r.q(V).datum(g);var q=V.append("span").classed("badge badge-light",!0);q.text(m.length);var L=V.append("h6").text(c+"  Predicted: "+O(s[0])+"-"+O(s[1])+" Observed: "+O(u[0])+"-"+O(u[1])),C=L.append("i").classed("close fas fa-times",!0);C.on("click",function(){var t=v.filter(function(t){return"data-filter"===t.filterType}).filter(function(t){return g.attribute!=t.attribute});K[0];t.forEach(function(t){console.log(t)}),j(n,a,i,o),r.r(".link-not-there").classed("link-not-there",!1),r.r(".node-not-there").classed("node-not-there",!1),V.remove()}),e.text("Show Filters"),t.selectAll("*").remove(),t.classed("hidden",!0),a.style("padding-top","0px")})}})}(i,t,e,n,a,o),function(t,e,n,a,o,i){var l=t.append("div").classed("search-bar-div",!0);l.append("h6").text("Query Filter:");var c=l.append("form").classed("form-inline",!0),s=c.append("input").classed("form-control mr-sm-2",!0);s.attr("type","search").attr("placeholder","Search by Species").attr("aria-label","Search"),c.append("button").classed("btn btn-outline-success my-2 my-sm-0",!0).attr("type","button").append("i").classed("fas fa-search",!0).on("click",function(){var l=s.node().value.split(" ").map(function(t){return t.toLowerCase()}),c=n.filter(function(t){var e=t.filter(function(t){return!0===t.leaf})[0].label;return l.indexOf(e)>-1});j(c,a,i,o);var u=r.q("#toolbar"),d=u.append("button").classed("btn btn-info",!0),f=d.append("span").classed("badge badge-light",!0);f.text(c.length),d.append("h6").text("Query Filter");var p=d.append("i").classed("close fas fa-times",!0);p.on("click",function(){j(n,a,i,o),d.remove()}),r.q("#main-path-view").style("height",function(){return 60*c.length+100*Object.keys(c[0][0].attributes).length+"px"}),e.text("Show Filters"),t.selectAll("*").remove(),t.classed("hidden",!0),a.style("padding-top","0px")})}(i,t,e,n,a,o)):(t.text("Show Filters"),i.selectAll("*").remove(),i.classed("hidden",!0),n.style("padding-top","0px"))}function h(t,e,n,r){return t.filter(function(t){return-1===t.map(function(t){var a=t.attributes[e].realVal;return 1==t.leaf?a>r[0]&&a<r[1]:a>n[0]&&a<n[1]}).indexOf(!1)})}function g(t,e,n,r){return t.filter(function(t){var a=t.filter(function(t){return 1!=t.leaf}).map(function(t){var r=t.attributes[e].states;return"Any"===n||r.filter(function(t){return t.state===n})[0].realVal>.75}),o=t.filter(function(t){return!0===t.leaf}).map(function(t){var n=t.attributes[e].winState;return"Any"===r||n===r});return a.indexOf(!0)>-1&&o.indexOf(!0)>-1})}function b(t,e,n,a){var o=t.append("div").classed("selector",!0);o.append("h6").text(a);return o.append("select").attr("id",n).attr("class","Any").selectAll("option").data(e).join("option").text(function(t){return t}).attr("value",function(t){return t}),r.q("#"+n).on("change",function(t){var e=r.q(this).property("value");r.q(this).attr("class",e)}),r.q("#"+n)}n(129),n(131);function y(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function x(t,e,n,a){var o=Object.keys(t[0][0].attributes),i=y(t);d(i,n,null);var l=r.l(i.map(function(t){return t.length}))-1;console.log("moveMetric",a);var c=r.o();"move"===a?c.domain([0,l-1]).clamp(!0):c.domain([0,1]).clamp(!0);var s=e.append("svg");s.attr("id","main-summary-view");var u=o.map(function(t){var e=i.map(function(t){return t.filter(function(t){return 1!=t.leaf})}),n=e.filter(function(t){return t.length===l}),a=r.l(n.flatMap(function(t){return t.flatMap(function(t){return t.edgeMove})})),o=e.map(function(e){var n=0;return e.map(function(o,i){var s,u,d=o.attributes[t],f=e.length-1,p=o.edgeLength+n;if(o.edgeMove=p,n+=o.edgeLength,"discrete"===d.type){var v=c;v.range([0,790]),d.move=v(i);var m=r.o().domain([0,a]).range([0,790]).clamp(!0);d.edgeMove=m(o.edgeMove),d.states=o.attributes[t].states.map(function(t){return t.move=d.move,t.edgeMove=d.edgeMove,t})}else{var h=c;h.range([0,790]);d.move=(u=l,h((s=i)<f?s:u-1));var g=r.o().domain([0,a]).range([0,790]).clamp(!0);d.edgeMove=g(o.edgeMove)}return d})});return o.attKey=t,o}).map(function(t){if("discrete"===t[0][0].type){var e=t.filter(function(t){return t.length===l})[0],o=t[0][0].states.map(function(t){return t.state}),i={stateData:{}};return o.forEach(function(o){var c=Array(l).fill({data:[]}).map(function(t,n){var r={data:t.data};return r.move=e[n].move,r.edgeMove=e[n].edgeMove,r});t.forEach(function(t){t.filter(function(t){return 1!=t.leaf}).map(function(t){return t.states.filter(function(t){return t.state===o})[0]}).forEach(function(t,e){var n=t;c[e].data.push(n)})}),i.stateData[o]={};var s=c.map(function(t){return t.data.filter(function(e){return e.move===t.move})});console.log("distrib",i);var u=s[0][0].color,d=y(n).filter(function(e){return e.field==t.attKey})[0].scales.filter(function(t){return t.scaleName==o})[0].yScale;d.range([0,80]),d.clamp(!0);var f=s.map(function(t){return r.m(t.map(function(t){return t.realVal}))}),p=s.map(function(t){return r.e(t.map(function(t){return t.realVal}))}),v=f.map(function(t,e){return t+p[e]}),m=f.map(function(t,e){return t-p[e]}),h=s.map(function(t){return r.m(t.map(function(t){return d(t.realVal)}))}),g=s.map(function(t){return r.e(t.map(function(t){return d(t.realVal)}))}),b=h.map(function(t,e){return t+g[e]}),x=h.map(function(t,e){return t-g[e]}),w=r.o().range([0,790]).domain([0,1]),A=c.map(function(t){return"move"===a?t.move:w(t.edgeMove)}).map(function(t,e){return{x:t,realMean:f[e],realStDev:p[e],realStUp:v[e],realStDown:m[e],scaleMean:h[e],scaleStDev:g[e],scaleStUp:b[e],scaleStDown:x[e]}});console.log("final",A),console.log("distribution",c),console.log("distrib",i),i.stateData[o].pathData=A,i.stateData[o].color=u}),i.attKey=t.attKey,i.type="discrete",i}t.type="continuous";var c=y(n).filter(function(e){return e.field==t.attKey})[0].yScale;c.range([0,80]),c.clamp(!0);var s=t.map(function(t){return t.map(function(t){return t.scaleVal=c(t.realVal),t.scaledHigh=c(t.upperCI95),t.scaledLow=c(t.lowerCI95),t})});return s.type="continuous",s.attKey=t.attKey,s}),f=o.map(function(t){var e=i.map(function(t){return t.filter(function(t){return!0===t.leaf})[0]}),a=e.map(function(e){var n=e.attributes[t];return"continuous"===n.type?n.realVal:"discrete"===n.type?n.winState:void console.error("attribute type not found")});if("discrete"===e[0].attributes[t].type){var o=n.filter(function(e){return e.field===t})[0].stateColors,l=e[0].attributes[t].states.map(function(t){return t.state}),c=l.map(function(t){var e=o.filter(function(e){return e.state==t})[0].color,n=r.o().domain([0,l.length-1]);return{key:t,count:a.filter(function(e){return e===t}).length,x:n,color:e}}),s=r.l(c.map(function(t){return t.count}));return c.forEach(function(t){t.max=s,t.y=r.o().domain([0,s+10])}),c}var u=n.filter(function(e){return e.field===t})[0].catColor,d=r.l(a),f=r.n(a),p=r.o().range([0,200]);p.domain([0,10]);var v=r.o().range([80,0]),m=r.i().value(function(t){return t}).domain([f,d]).thresholds(p.ticks(10))(a),h=r.l(m.map(function(t){return t.length}));return v.domain([0,h]),m.map(function(t){return t.x=p,t.y=v,t.color=u,t})}).map(function(t,e){return{observed:t,predicted:u[e]}}),p=s.selectAll(".combined-attr-grp").data(f).join("g").classed("combined-attr-grp",!0);p.attr("transform",function(t,e){return"translate(0,"+110*e+")"});var v=p.append("g").classed("summary-attr-grp",!0),m=v.append("g").classed("inner-attr-summary",!0);m.attr("transform","translate(105, 0)"),m.append("line").attr("x1",0).attr("y1",40).attr("x2",800).attr("y2",40).attr("stroke","gray").attr("stroke-width",.5),m.append("rect").classed("attribute-rect-sum",!0).attr("x",0).attr("y",0).attr("height",80).attr("width",800),v.append("text").text(function(t){return t.predicted.attKey}).attr("x",100).attr("y",25).attr("text-anchor","end");var h=m.filter(function(t){return"continuous"===t.predicted.type}).selectAll("g.summ-paths").data(function(t){return t.predicted}).join("g").classed("summ-paths",!0),g=r.k().x(function(t){return"move"===a?t.move:t.edgeMove}).y(function(t){return t.scaleVal}),b=(h.append("path").attr("d",g).attr("class","inner-line-sum").style("stroke",function(t){return t[0].color}),h.selectAll(".node-sum").data(function(t){return t}).join("g").attr("class","node-sum"));b.attr("transform",function(t,e){return"move"===a?"translate("+t.move+", 0)":"translate("+t.edgeMove+", 0)"}),b.append("rect").attr("x",0).attr("y",0).attr("width",10).attr("height",80).classed("inner-node-wrap",!0),b.append("rect").attr("x",0).attr("y",function(t,e){return t.scaledLow}).attr("width",10).attr("height",function(t,e){return t.scaledHigh-t.scaledLow}).classed("range-rect-sum",!0).style("fill",function(t){return t.color}),s.attr("height",120*u.length);var x=m.filter(function(t){return"discrete"===t.predicted.type}).classed("discrete-sum",!0).selectAll(".state-sum").data(function(t){return Object.entries(t.predicted.stateData).map(function(t){return t[1]})}).join("g").classed("state-sum",!0),w=r.k().x(function(t){return t.x}).y(function(t){return t.scaleMean}),A=(x.append("path").attr("d",function(t){return w(t.pathData)}).attr("class","inner-line-sum-discrete").style("stroke",function(t,e){return t.color}),r.a().x(function(t){return console.log(t),t.x}).y0(function(t){return t.scaleStDown}).y1(function(t){return t.scaleStUp})),S=(x.append("path").attr("fill",function(t){return t.color}).attr("d",function(t){return console.log(t.pathData),A(t.pathData)}).classed("state-area-sum",!0),p.append("g").classed("observed-att",!0));S.attr("transform","translate(920, 0)"),S.append("rect").attr("width",200).attr("height",80).attr("x",0).attr("y",0).classed("wrapper-rect",!0);var k=S.filter(function(t){return"discrete"===t.predicted.type}).selectAll(".state-bar").data(function(t){return t.observed}).join("g").classed("state-bar",!0);k.attr("transform",function(t,e){return t.x.range([0,180]),console.log("d",t),"translate("+t.x(e)+",0)"}),k.append("rect").classed("graph-bars",!0).attr("x",0).attr("height",function(t,e){var n=r.o().domain([0,t.max+10]).range([80,0]);return n(0)-n(t.count)}).attr("y",function(t,e){return 80-r.o().domain([0,t.max+10]).range([0,80])(t.count)}).attr("width",20).style("fill",function(t){return t.color}),k.append("g").attr("transform","translate(0, 80)").append("text").text(function(t){return t.key}).style("text-anchor","end").attr("dx","-.1em").attr("dy",".8em").style("font-size",9).attr("transform","rotate(-35)"),S.filter(function(t){return"continuous"===t.predicted.type}).selectAll(".bin-bar").data(function(t){return t.observed}).join("g").classed("bin-bar",!0).append("rect").attr("class","bar").attr("x",1).attr("transform",function(t,e){return"translate("+t.x(e)+","+t.y(t.length)+")"}).attr("width",10).attr("height",function(t){return 80-t.y(t.length)}).attr("fill",function(t){return t.color})}function w(t,e,n,r,a,o){console.log("collapsing?",R);var i=t.append("button").attr("id","view-toggle").attr("attr","button").attr("class","btn btn-outline-secondary");"paths"===o?i.text("View Summary"):"summary"===o?i.text("View Paths"):console.error("pathView parameter not found");var l=t.append("button").attr("id","view-filter");l.attr("class","btn btn-outline-secondary").text("Show Filters"),l.on("click",function(){return m(l,e,n,a,r)});var c=t.append("button").attr("id","change-length").attr("class","btn btn-outline-secondary");"move"===a?c.text("Show Edge Length"):"edgeLength"===a&&c.text("Normalize Edge Length"),c.on("click",function(){"Show Edge Length"===c.text()?(c.text("Normalize Edge Length"),n.selectAll("*").remove(),"View Summary"===i.text()?j(e,n,r,"edgeLength"):x(e,n,r,"edgeLength")):(c.text("Show Edge Length"),n.selectAll("*").remove(),"View Summary"===i.text()?j(e,n,r,a):x(e,n,r,a))});var s=t.append("button").attr("id","scrunch");s.attr("class","btn btn-outline-secondary").text("Collapse Attributes"),s.attr("value",!1),s.on("click",function(){return function(t,e,n,r){"Collapse Attributes"===t.text()?(t.text("Expand Attributes"),n.selectAll("*").remove(),t.attr("value",!0),j(e,n,r,"edgeLength")):(t.text("Collapse Attributes"),n.selectAll("*").remove(),t.attr("value",!1),j(e,n,r,"edgeLength"))}(s,e,n,r)}),i.on("click",function(){return function(t,e,n,r,a){"View Paths"===t.text()?(t.text("View Summary"),n.selectAll("*").remove(),j(e,n,r,a)):(t.text("View Paths"),n.selectAll("*").remove(),x(e,n,r,a))}(i,e,n,r,a)})}function A(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function S(t,e,n,a){var o=r.q("div#selected");if(null===t){r.q("div#selected").selectAll("*").remove(),o.style("height",0),r.q("div#main").style("padding-top","0px");var i=r.q("div#main");j(A(e),i,n,a)}else{!function(t,e,n,a,o){var i=t.flatMap(function(t){return t.filter(function(t){return!0===t.leaf}).map(function(t){return t.node})}),l=r.q("#sidebar").select("svg").selectAll(".node");l.filter(function(t){return i.indexOf(t.data.node)>-1}).classed("selected",!0);var c=v.filter(function(t){return"hide-attribute"===t.type}).length>0?v.filter(function(t){return"hide-attribute"===t.type}).map(function(t){return t.attribute}):[],s=c.length>0?a.filter(function(t){return-1===c.indexOf(t.field)}).map(function(t){return t.field}):null,u=n.select(".selected-toolbar"),f=u.empty()?n.append("div").classed("selected-toolbar",!0):u;f.selectAll("*").remove(),f.append("div").classed("x-icon",!0).append("i").classed("far fa-times-circle",!0).on("click",function(){r.r(".high").classed("high",!1),r.r(".low").classed("low",!1),l.select(".selected").classed("selected",!1),S(null,K[0],a,o)});var p=f.append("div").style("display","inline-block");p.append("text").text("Topology: ");var m=p.append("button").classed("btn btn-secondary btn-sm",!0);m.text("Sort Most to Least"),m.on("click",function(){var t;"Sort Most to Least"===(t=m).text()?t.text("Sort Least to Most"):t.text("Sort Most to Least")});var h=a.map(function(t){return t.field}),g=f.append("div").style("display","inline-block");g.append("h6").text("Sort by: ").style("display","inline");var b=g.selectAll("div.attr-radio").data(h).join("div").classed("attr-radio form-check form-check-inline",!0),y=b.append("input").attr("type","radio").property("name","attribute-radio-sort").property("value",function(t){return t}).attr("id",function(t,e){return"radio-"+e}).classed("form-check-input",!0);b.append("label").text(function(t){return t}).property("for",function(t,e){return"radio-"+e}).classed("form-check-label",!0),y.on("click",function(n,i){var c=t.map(function(t){return t.filter(function(t){return!0===t.leaf})[0]})[0],s=A(e).sort(function(t,e){return t.filter(function(t){return!0===t.leaf})[0].attributes[n].realVal-e.filter(function(t){return!0===t.leaf})[0].attributes[n].realVal}),u=r.q("div#main");j(s.reverse(),u,a,o),u.style("padding-top","250px");var d=u.select("svg#main-path-view").selectAll(".paths"),f=d.filter(function(t){var e=t.filter(function(t){return!0===t.leaf})[0];return e.attributes[n].realVal>c.attributes[n].realVal});f.classed("high",!0);var p=f.data().map(function(t){return t.filter(function(t){return!0===t.leaf})[0].node});l.filter(function(t){return p.indexOf(t.data.node)>-1}).classed("high",!0);var v=d.filter(function(t){var e=t.filter(function(t){return!0===t.leaf})[0];return e.attributes[n].realVal<c.attributes[n].realVal});v.classed("low",!0);var m=v.data().map(function(t){return t.filter(function(t){return!0===t.leaf})[0].node});l.filter(function(t){return m.indexOf(t.data.node)>-1}).classed("low",!0);var h=d.filter(function(t){var e=t.filter(function(t){return!0===t.leaf})[0];return e.attributes[n].realVal===c.attributes[n].realVal});h.classed("same",!0)});var x=n.select("svg.select-svg"),w=x.empty()?n.append("svg").classed("select-svg",!0):x,k=w.append("g").classed("select-wrap",!0),O=V(t,k,a,o);O.attr("transform",function(t,e){return"translate(0,"+60*e+")"}),O.select(".time-line").selectAll(".node").on("mouseover",function(t,n){var r=e.filter(function(e){var n=e.flatMap(function(t){return t.node});return n.indexOf(t.node)>-1});r[0],r[1]});var M=O.append("g").classed("attribute-wrapper",!0),E=d(t,a,s),I=q(M,E,a,null);O.attr("transform",function(t,e){return"translate(10,"+e*(50*(Object.keys(t[1].attributes).length+1))+")"}),L(I),C(I,a),w.style("height",250*(t.length+I.data().map(function(t){return t[0]}).length)+50+"px"),n.style("height",45*(t.length+I.data().map(function(t){return t[0]}).length)+50+"px"),M.attr("transform",function(t){return"translate(140, 25)"}),r.r(".selected-path").classed("selected-path",!1)}([t],e,o,n,a);var l=function(t,e){t.filter(function(t){return t.leaf})[0];var n=t.reverse().map(function(t){return t.node});return e.map(function(t){var e=t.reverse().map(function(t,e){return n.indexOf(t.node),{indexOf:n.indexOf(t.node),pathIndex:e,node:t,chosen:n[n.indexOf(t.node)]}}).filter(function(t){return t.indexOf>-1}),r=e[0].indexOf+e[0].pathIndex;return{data:t.reverse(),distance:r}}).sort(function(t,e){return t.distance-e.distance})}(A(t),e),c=r.q("div#main");j(l.map(function(t){return t.data}),c,n,a),c.style("padding-top","250px")}}function k(t,e,n,r,a,o,i){try{var l=t[o](i),c=l.value}catch(t){return void n(t)}l.done?e(c):Promise.resolve(c).then(r,a)}function j(t,e,n,a){var o=r.q("#scrunch").attr("value");console.log("in attr render",o),e.select("#main-path-view").selectAll("*").remove();var i=V(t,e,n,a),l=i.append("g").classed("attribute-wrapper",!0),c=v.filter(function(t){return"hide-attribute"===t.type}),s=c.length>0?n.filter(function(t){return t.field!=c[0].attribute}).map(function(t){return t.field}):null,u=d(t,n,s),f=null===s?n.length:s.length,p=q(l,u,n,null,o),m="true"===o?20:45;i.attr("transform",function(t,e){return"translate(10,"+e*((m+10)*f+10)+")"}),L(p,a,o),C(p,n,a,o),O(e.select("#main-path-view"),l,t,f*m)}function O(t,e,n,r){t.style("height",n.length*(r+52)+"px"),e.attr("transform",function(t){return"translate(140, 25)"})}function V(t,e,n,a){var o=e.select("#main-path-view"),i=o.empty()?e.append("svg").attr("id","main-path-view"):o,l=i.select(".path-wrapper"),c=l.empty()?i.append("g").classed("path-wrapper",!0):l;c.attr("transform",function(t,e){return"translate(0,20)"});var s=t.flatMap(function(t){return t.flatMap(function(t){return t.node})}).reduce(function(t,e){return void 0===t[e]?t[e]=1:t[e]+=1,t},{}),u=r.p().range([6,14]).domain([1,r.l(Object.values(s))]),d=c.selectAll(".paths").data(t).join("g").classed("paths",!0);d.append("rect").classed("path-rect",!0).attr("y",-8),d.on("mouseover",function(t,e){var n=r.q("#sidebar").selectAll(".node"),a=r.q("#sidebar").selectAll(".link");return n.filter(function(e){return t.map(function(t){return t.node}).indexOf(e.data.node)>-1}).classed("hover",!0),a.filter(function(e){return t.map(function(t){return t.node}).indexOf(e.data.node)>-1}).classed("hover",!0),r.q(this).classed("hover",!0)}).on("mouseout",function(t,e){r.q("#sidebar").selectAll(".node").classed("hover",!1),r.q("#sidebar").selectAll(".link").classed("hover",!1);return r.q(this).classed("hover",!1)}),d.on("click",function(t,e,o){var i=r.r(o).filter(function(t,n){return n!=e}).classed("selected-path",!1);r.q(o[e]).classed("selected-path")?(r.q(o[e]).classed("selected-path",!1),S(null,i.data(),n,a)):(r.q(o[e]).classed("selected-path",!0),S(t,i.data(),n,a))}),d.append("text").text(function(t){var e=t.filter(function(t){return!0===t.leaf})[0].label;return e.charAt(0).toUpperCase()+e.slice(1)}).attr("x",10).attr("y",15);var f=d.append("g").classed("time-line",!0);f.attr("transform",function(t,e){return"translate(150, 0)"});f.append("line").attr("x1",0).attr("x2",1e3).attr("y1",15).attr("y2",15);var p=f.selectAll(".node").data(function(t){return t}).join("g").classed("node",!0);p.attr("transform",function(t){var e=r.o().domain([0,1]).range([0,1e3]);return"translate("+("move"===a?t.move:e(t.edgeMove))+", 10)"}),p.append("circle").attr("cx",0).attr("cy",0).attr("r",function(t){return u(s[t.node])}).attr("class",function(t,e){return"node-"+t.node}).on("mouseover",function(t,e){var n=p.filter(function(e){return e.node===t.node});r.q("#sidebar").selectAll(".node").filter(function(e){return e.data.node===t.node}).classed("selected-branch",!0);return n.classed("hover-branch",!0)}).on("mouseout",function(t,e){var n=p.filter(function(e){return e.node===t.node});return r.r(".selected-branch").classed("selected-branch",!1),n.classed("hover-branch",!1)});p.filter(function(t){return null!=t.label}).append("text").text(function(t){return t.label.charAt(0).toUpperCase()+t.label.slice(1)}).attr("x",10).attr("y",5);return d}function q(t,e,n,r,a){var o="true"===a?20:45,i=t.selectAll("g").data(function(t,n){return e[n]}).join("g");return i.attr("transform",function(t,e){return"translate(0, "+e*(o+5)+")"}),i}function M(){var t;return t=regeneratorRuntime.mark(function t(e,n,a){var o,i,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.data().forEach(function(t){var e;(e=t).map(function(t,n){var r=0===n?0:1,a=t.realVal>e[n-r].realVal?1:18;t.change=a})}),o="true"===a?20:45,i=r.k().x(function(t){var e=r.o().domain([0,1]).range([0,1e3]);return"move"===n?t.move:e(t.edgeMove)}).y(function(t){var e=t.yScale;return e.range([o,0]),"true"===a?t.change:e(t.realVal)}),l=e.append("path").attr("d",i).attr("class","inner-line").style("stroke",function(t){return t[0].color}),t.abrupt("return",l);case 5:case"end":return t.stop()}},t)}),(M=function(){var e=this,n=arguments;return new Promise(function(r,a){var o=t.apply(e,n);function i(t){k(o,r,a,i,l,"next",t)}function l(t){k(o,r,a,i,l,"throw",t)}i(void 0)})}).apply(this,arguments)}function L(t,e,n){var a=t.filter(function(t){return"continuous"===t[0].type}),o="true"===n?20:45,i=a.append("text").text(function(t){return t[0].label});i.classed("attribute-label",!0),i.attr("transform","translate(-15, 20)");var l=a.append("g").classed("attribute-time-line",!0);l.append("rect").classed("attribute-rect",!0).attr("height",o);var c=l.selectAll("g").data(function(t){return t}).join("g").classed("attribute-node",!0).append("g").classed("inner-bars",!0);!function(t,e,n){M.apply(this,arguments)}(l,e,n);c.append("rect").classed("attribute-inner-bar",!0).attr("height",o),c.attr("transform",function(t){var n=r.o().domain([0,1]).range([0,1e3]);return"translate("+("move"===e?t.move:n(t.edgeMove))+", 0)"});var s=c.append("rect").classed("range-rect",!0);s.attr("width",20).attr("height",function(t,e){var r=t.yScale;r.range([o,0]);var a=t.leaf?0:r(t.lowerCI95)-r(t.upperCI95);return"true"===n?20:a}),s.attr("transform",function(t,e){var r=t.yScale;return r.range([o,0]),"translate(0, "+(t.leaf||"true"===n?0:r(t.upperCI95))+")"}),s.style("fill",function(t){return t.colorScale(t.realVal)}),s.attr("opacity",function(t){return t.satScale(t.realVal)}),"true"!=n&&c.append("rect").attr("width",20).attr("height",5).attr("transform",function(t,e){var n=t.yScale;return n.range([o,0]),"translate(0, "+n(t.realVal)+")"}).attr("fill",function(t){return t.color})}function C(t,e,n,a){console.log("collapsed in draw discrete",a,r.q("#scrunch").attr("value"));var o=t.filter(function(t){return"discrete"===t[t.length-1].type}),i="true"===a?20:45,l=o.append("text").text(function(t){return t[t.length-1].label});l.classed("attribute-label",!0),l.attr("transform","translate(-15, 20)");var c=o.append("g").classed("attribute-time-line",!0);c.append("line").classed("half",!0).attr("x1",0).attr("y1",22).attr("x2",1010).attr("y2",22);var s=c.selectAll("g").data(function(t){var e=t.map(function(t){return 1==t.leaf?t.states.map(function(e){return e.move=t.move,e.edgeMove=t.edgeMove,e.color=t.color,e}):t});return e[0].map(function(t){return t.state}).map(function(t){return e.map(function(e){return e.filter(function(e){return e.state==t})[0]})})}).join("g").classed("state-path",!0),u=r.k().x(function(t){var e=r.o().domain([0,1]).range([0,1e3]);return("move"===n?t.move:e(t.edgeMove))+7}).y(function(t){return r.o().domain([0,1]).range([i-2,1])(t.realVal)});s.append("path").attr("d",u).attr("class","inner-line").style("stroke-width",.7).style("stroke",function(t){return t[0].color});c.append("rect").classed("attribute-rect",!0).attr("height",i);var d=c.selectAll(".attribute-node-discrete").data(function(t){return t}).join("g").classed("attribute-node-discrete",!0);d.attr("transform",function(t){var e=r.o().domain([0,1]).range([0,1e3]);return t[0]?"translate("+("move"===n?t[0].move:e(t[0].edgeMove))+", 0)":"translate("+("move"===n?t.move:e(t.edgeMove))+", 0)"}),d.append("line").attr("x1",10).attr("x2",10).attr("y1",0).attr("y2",i);var f=d.filter(function(t,e){return null!=t[0]}).selectAll(".dots").data(function(t){return t}).join("circle").classed("dots",!0);f.attr("cx",10).attr("cy",function(t){return r.o().domain([0,1]).range([i-2,2])(t.realVal)}).attr("r",2).style("fill",function(t){return t.color}),f.filter(function(t){return t.realVal>.5}).attr("r",4),f.on("mouseover",function(t){var e=r.q("#tooltip");e.transition().duration(200).style("opacity",.9);var n=r.g(".3f");e.html(t.state+": "+n(t.realVal)).style("left",r.f.pageX+"px").style("top",r.f.pageY-28+"px")}).on("mouseout",function(t){r.q("#tooltip").transition().duration(500).style("opacity",0)});var p=d.filter(function(t,e){return void 0===t[0]});p.append("circle").attr("cx",10).attr("cy",2).attr("r",7).style("fill",function(t){return t.color}),p.append("text").text(function(t){return t.winState}).attr("transform","translate(15, 17)").style("font-size",10)}n(132);function E(t,e,n,r,a,o,i){try{var l=t[o](i),c=l.value}catch(t){return void n(t)}l.done?e(c):Promise.resolve(c).then(r,a)}function I(t){return function(){var e=this,n=arguments;return new Promise(function(r,a){var o=t.apply(e,n);function i(t){E(o,r,a,i,l,"next",t)}function l(t){E(o,r,a,i,l,"throw",t)}i(void 0)})}}function P(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function T(t,e){return function t(e,n){return e.children=n.filter(function(t){return String(t.V1)===String(e.node)}),e.name=String(e.node),e.children.length>0?(e.children.forEach(function(e){return t(e,n)}),e):e}(t[0][0],e.rows)}function F(){var t=this,e=r.q("#sidebar"),n=r.q("#main"),a=r.q("#toolbar"),o=e.select("svg").select("g").selectAll(".node").filter(function(t){return t.y>r.f.selection[0][0]&&t.y<r.f.selection[1][0]&&t.x>r.f.selection[0][1]&&t.x<r.f.selection[1][1]}).classed("selected",!0).data().map(function(t){return t.data.node}),i=treeFilter(normedPaths,o),l={filterType:"data-filter","attribute-type":"topology",filterFunction:treeFilter,"before-data":P(normedPaths),data:P(i)};v.push(l),j(i,n,calculatedScales,"edgeLength");var c=r.q("#sidebar").selectAll(".link"),s=r.q("#sidebar").selectAll(".node"),u=i.flatMap(function(t){return t.map(function(t){return t.node})});r.r(".link-not-there").classed("link-not-there",!1),r.r(".node-not-there").classed("node-not-there",!1),c.filter(function(t){return-1===u.indexOf(t.data.node)}).classed("link-not-there",!0),s.filter(function(t){return-1===u.indexOf(t.data.node)}).classed("node-not-there",!0);var d=a.append("button").classed("btn btn-info",!0);d.append("span").classed("badge badge-light",!0).text(i.length),d.append("h6").text("Tree Filter").append("i").classed("close fas fa-times",!0).on("click",I(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(normedPaths,n,calculatedScales,"edgeLength");case 2:r.r(".selected").classed("selected",!1),r.r(".link-not-there").classed("link-not-there",!1),r.r(".node-not-there").classed("node-not-there",!1),d.remove(),r.q(t).call(treeBrush.move,null);case 7:case"end":return e.stop()}},e)})))}function D(t,e,n,r){r.append("button").text("Filter by Tree").classed("btn btn-outline-secondary",!0).on("click",function(){treeBrush.on("end",F);r.select("svg").append("g").classed("tree-brush",!0).call(treeBrush)});var a=r.append("button").text("Show Lengths").classed("btn btn-outline-secondary",!0);a.on("click",function(){console.log("renderTree"),r.select("svg").remove(),"Show Lengths"===a.text()?(N(t,e,n,r,!0),a.text("Hide Lengths")):(N(t,e,n,r,!1),a.text("Show Lengths"))})}function N(t,e,n,a,o){r.c().extent([[0,0],[400,600]]);var i=10,l=90,c=50,s=20,u=400-s-l,d=700-i-c,f=r.s().size([d,u]);!function t(e,n){n.combEdge=n.edgeLength+e,n.children&&n.children.forEach(function(e){t(n.combEdge,e)})}(0,t);var p=r.h(t);p=f(p);var v=r.o().domain([0,1]).range([0,u]).clamp(!0),m=a.append("svg").attr("width",u+s+l).attr("height",d+i+c).append("g").attr("transform","translate("+s+","+i+")"),h=(m.selectAll(".link").data(p.descendants().slice(1)).join("path").attr("class","link").attr("d",function(t){return o?"M"+v(t.data.combEdge)+","+t.x+"C"+(v(t.data.combEdge)+v(t.parent.data.combEdge))/2+","+t.x+" "+(v(t.data.combEdge)+v(t.parent.data.combEdge))/2+","+t.parent.x+" "+v(t.parent.data.combEdge)+","+t.parent.x:"M"+t.y+","+t.x+"C"+(t.y+t.parent.y)/2+","+t.x+" "+(t.y+t.parent.y)/2+","+t.parent.x+" "+t.parent.y+","+t.parent.x}),m.selectAll(".node").data(p.descendants()).join("g").attr("class",function(t){return"node"+(t.children?" node--internal":" node--leaf")}).attr("transform",function(t){return o?"translate("+v(t.data.combEdge)+","+t.x+")":"translate("+t.y+","+t.x+")"}));return h.append("circle").attr("r",3),h.on("mouseover",function(t,e,n){r.q("#main-path-view").selectAll(".paths").filter(function(e){return e.map(function(t){return t.node}).indexOf(t.data.node)>-1}).classed("hover",!0).selectAll("g").filter(function(e){return e.node===t.data.node}).classed("selected",!0),r.q(n[e]).classed("selected-branch",!0)}).on("mouseout",function(t,e,n){r.r(".paths.hover").classed("hover",!1),r.r("g.selected").classed("selected",!1),r.q(n[e]).classed("selected-branch",!1)}),h}function _(t,e,n,r,a,o,i){try{var l=t[o](i),c=l.value}catch(t){return void n(t)}l.done?e(c):Promise.resolve(c).then(r,a)}n.d(e,"dataMaster",function(){return K}),n.d(e,"collapsed",function(){return R});var K=[],R=!1,H=r.q("#wrapper"),z=H.select("#main"),U=(H.select("#selected"),H.select("#sidebar")),B=H.select("#toolbar");H.append("div").attr("id","tooltip").style("opacity",0);o(r.j,"./public/data/anolis-edges.json","edge").then(function(){var t,e=(t=regeneratorRuntime.mark(function t(e){var n,a,i,d,p,v,m,h,g,b,y,x;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return Array.prototype.unique=function(){return this.filter(function(t,e,n){return n.indexOf(t)===e})},t.next=3,o(r.j,"./public/data/anolis-edge-length.json","edge");case 3:return n=t.sent,a=e.rows.map(function(t){return t.V1}),i=e.rows.filter(function(t){return-1==a.indexOf(t.V2)}),t.next=8,o(r.j,"./public/data/anolisLeafChar.json","");case 8:return d=t.sent,t.next=11,o(r.j,"./public/data/anolis-labels.json","");case 11:return p=t.sent,t.next=14,o(r.j,"./public/data/anolis-awesomeness-res.json","continuous");case 14:return t.t0=t.sent,t.next=17,o(r.j,"./public/data/anolis-island-res.json","discrete");case 17:return t.t1=t.sent,t.next=20,o(r.j,"./public/data/anolis-svl-res.json","continuous");case 20:return t.t2=t.sent,t.next=23,o(r.j,"./public/data/anolis-ecomorph-res.json","discrete");case 23:t.t3=t.sent,v={awesomeness:t.t0,island:t.t1,SVL:t.t2,ecomorph:t.t3},m=l(v,[["#0dc1d1","#c8f7fd"],["#3AD701","#2a9b01"],["#fec303","#d3a001"],["#fe4ecb","#d30197"],["#f36b2c"],["#1abc9c"],["#493267"],["#a40b0b"],["#0095b6"]]),h=c(p,i,d,m),g=s(e,n,v,m),b=f(g,h,"V1","V2"),y=u(b,v,m),K.push(y),w(B,y,z,m,"edgeLength","paths"),H.select("#filter-tab").classed("hidden",!0),D(x=T(b,e),y,m,U),N(x,0,0,U,!1),j(y,z,m,"edgeLength");case 38:case"end":return t.stop()}},t)}),function(){var e=this,n=arguments;return new Promise(function(r,a){var o=t.apply(e,n);function i(t){_(o,r,a,i,l,"next",t)}function l(t){_(o,r,a,i,l,"throw",t)}i(void 0)})});return function(t){return e.apply(this,arguments)}}())},21:function(t,e,n){}});
//# sourceMappingURL=app.cff4f256.js.map